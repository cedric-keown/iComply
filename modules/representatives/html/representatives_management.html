<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Representatives Management - iComply</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Phoenix Theme CSS -->
    <link href="https://prium.github.io/phoenix/v1.23.0/assets/css/phoenix.min.css" rel="stylesheet">
    <link href="https://prium.github.io/phoenix/v1.23.0/assets/css/theme.min.css" rel="stylesheet">
    <!-- SweetAlert2 -->
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- Custom Styles -->
    <link href="../../../css/main.css" rel="stylesheet">
    <link href="../css/representatives-styles.css" rel="stylesheet">
</head>
<body>
    <!-- Navigation Tabs -->
    <div class="representatives-tabs-container">
        <ul class="nav nav-tabs representatives-tabs" id="representativesTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab">
                    <i class="fas fa-chart-pie me-2"></i>Representatives Dashboard
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="directory-tab" data-bs-toggle="tab" data-bs-target="#directory" type="button" role="tab">
                    <i class="fas fa-users me-2"></i>Representative Directory
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="add-tab" data-bs-toggle="tab" data-bs-target="#add" type="button" role="tab">
                    <i class="fas fa-user-plus me-2"></i>Add New Representative
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="supervision-tab" data-bs-toggle="tab" data-bs-target="#supervision" type="button" role="tab">
                    <i class="fas fa-sitemap me-2"></i>Supervision Structure
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="compliance-tab" data-bs-toggle="tab" data-bs-target="#compliance" type="button" role="tab">
                    <i class="fas fa-shield-check me-2"></i>Compliance Overview
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="debarment-tab" data-bs-toggle="tab" data-bs-target="#debarment" type="button" role="tab">
                    <i class="fas fa-ban me-2"></i>Debarment Register
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="reports-tab" data-bs-toggle="tab" data-bs-target="#reports" type="button" role="tab">
                    <i class="fas fa-file-alt me-2"></i>Reports
                </button>
            </li>
        </ul>
    </div>

    <!-- Tab Content -->
    <div class="tab-content representatives-content" id="representativesTabContent">
        <!-- 1. REPRESENTATIVES DASHBOARD -->
        <div class="tab-pane fade show active" id="dashboard" role="tabpanel">
            <div class="container-fluid py-4">
                <!-- Overview Statistics Cards -->
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="stat-card">
                            <div class="stat-icon text-primary">
                                <i class="fas fa-users fa-3x"></i>
                            </div>
                            <div class="stat-value" id="repsTotalValue">-</div>
                            <div class="stat-label">Total Representatives</div>
                            <div class="stat-sublabel">Active representatives</div>
                            <small class="text-muted d-block mt-2" id="repsStatusBreakdown">Loading...</small>
                            <a href="#" class="btn btn-sm btn-link mt-2" onclick="switchRepsTab('directory-tab')">View All</a>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="stat-card">
                            <div class="stat-icon text-success">
                                <i class="fas fa-shield-check fa-3x"></i>
                            </div>
                            <div class="stat-value text-success" id="repsComplianceValue">-</div>
                            <div class="stat-label">Compliance Status</div>
                            <div class="stat-sublabel" id="repsComplianceSublabel">Loading...</div>
                            <small class="text-muted d-block mt-2" id="repsComplianceDetails">Loading...</small>
                            <a href="#" class="btn btn-sm btn-link mt-2" onclick="switchRepsTab('compliance-tab')">View Issues</a>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="stat-card">
                            <div class="stat-icon text-info">
                                <i class="fas fa-clock fa-3x"></i>
                            </div>
                            <div class="stat-value text-info" id="repsCpdDueValue">-</div>
                            <div class="stat-label">CPD Due Soon</div>
                            <div class="stat-sublabel" id="repsCpdDueSublabel">Loading...</div>
                            <div class="alert alert-info mb-0 mt-2">
                                <small><strong id="repsCpdDaysRemaining">Loading...</strong></small>
                            </div>
                            <a href="#" class="btn btn-sm btn-info mt-2">Review CPD</a>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="stat-card">
                            <div class="stat-icon text-warning">
                                <i class="fas fa-award fa-3x"></i>
                            </div>
                            <div class="stat-value text-warning" id="repsFpRenewalsValue">-</div>
                            <div class="stat-label">Fit & Proper Renewals</div>
                            <div class="stat-sublabel" id="repsFpRenewalsSublabel">Loading...</div>
                            <a href="#" class="btn btn-sm btn-link mt-2" onclick="switchRepsTab('compliance-tab')">Review F&P</a>
                        </div>
                    </div>
                </div>

                <!-- Regulatory Compliance Card -->
                <div class="card mb-4">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="mb-0"><i class="fas fa-exclamation-triangle me-2"></i>FAIS Act Compliance</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3 text-center">
                                <div class="h4 mb-0"><span class="badge bg-secondary fs-6" id="repsOverallStatus">Loading...</span></div>
                                <small class="text-muted">Overall Status</small>
                            </div>
                            <div class="col-md-3 text-center">
                                <div class="h4 mb-0" id="repsCompliantCount">-</div>
                                <small class="text-muted" id="repsCompliantPercentage">Loading...</small>
                            </div>
                            <div class="col-md-3 text-center">
                                <div class="h4 mb-0"><span class="badge bg-secondary" id="repsFpStatus">Loading...</span></div>
                                <small class="text-muted">All Fit & Proper</small>
                            </div>
                            <div class="col-md-3 text-center">
                                <div class="h4 mb-0"><span class="badge bg-secondary" id="repsCpdStatus">Loading...</span></div>
                                <small class="text-muted">All CPD Current</small>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-md-6">
                                <h6>Regulatory Requirements:</h6>
                                <ul class="list-unstyled">
                                    <li><i class="fas fa-clipboard-list text-primary me-2"></i>Fit & Proper: All reps must maintain F&P status</li>
                                    <li><i class="fas fa-graduation-cap text-info me-2"></i>CPD: 30 hours annually (20 general + 10 specific)</li>
                                    <li><i class="fas fa-search text-success me-2"></i>FICA: All reps must be verified</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <ul class="list-unstyled">
                                    <li><i class="fas fa-user-tie text-warning me-2"></i>Supervision: Key Individual per FSP category</li>
                                    <li><i class="fas fa-ban text-danger me-2"></i>Debarment: Monthly checks required</li>
                                    <li><i class="fas fa-file-alt text-secondary me-2"></i>Record Retention: 5 years post-termination</li>
                                    <li><i class="fas fa-calendar-check text-info me-2"></i>Last FSCA Update: 30/11/2024</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Status Breakdown -->
                <div class="row mb-4">
                    <div class="col-md-3 mb-4">
                        <div class="status-card bg-success text-white">
                            <div class="status-icon"><i class="fas fa-check-circle fa-2x"></i></div>
                            <div class="status-value">12</div>
                            <div class="status-label">Active</div>
                            <p class="mb-0 small">Currently licensed and compliant</p>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="status-card bg-warning text-dark">
                            <div class="status-icon"><i class="fas fa-exclamation-circle fa-2x"></i></div>
                            <div class="status-value">0</div>
                            <div class="status-label">Probation</div>
                            <p class="mb-0 small">New representatives under supervision</p>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="status-card bg-danger text-white">
                            <div class="status-icon"><i class="fas fa-times-circle fa-2x"></i></div>
                            <div class="status-value">1</div>
                            <div class="status-label">Non-Compliant</div>
                            <p class="mb-0 small">Pieter Botha (CPD behind)</p>
                            <a href="#" class="btn btn-sm btn-light mt-2">Resolve Issues</a>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="status-card bg-secondary text-white">
                            <div class="status-icon"><i class="fas fa-archive fa-2x"></i></div>
                            <div class="status-value">3</div>
                            <div class="status-label">Terminated</div>
                            <p class="mb-0 small">No longer with FSP (historical records)</p>
                        </div>
                    </div>
                </div>

                <!-- Representatives Requiring Attention -->
                <div class="card mb-4">
                    <div class="card-header bg-warning bg-opacity-10">
                        <h5 class="mb-0">
                            <i class="fas fa-exclamation-triangle text-warning me-2"></i>
                            Representatives Requiring Attention
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th>Representative</th>
                                        <th width="100">Score</th>
                                        <th width="150">Status</th>
                                        <th width="120">Issues</th>
                                        <th width="150">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Sarah Naidoo</td>
                                        <td><span class="badge bg-success">✅ Current</span></td>
                                        <td><span class="badge bg-success">✅ 32/30hrs</span></td>
                                        <td><span class="badge bg-success">✅ Verified</span></td>
                                        <td><span class="badge bg-success">✅ Clear</span></td>
                                        <td><span class="badge bg-success">✅ Compliant</span></td>
                                        <td><button class="btn btn-sm btn-outline-primary">View</button></td>
                                    </tr>
                                    <tr>
                                        <td>Thabo Mokoena</td>
                                        <td><span class="badge bg-success">✅ Current</span></td>
                                        <td><span class="badge bg-success">✅ 30/30hrs</span></td>
                                        <td><span class="badge bg-success">✅ Verified</span></td>
                                        <td><span class="badge bg-success">✅ Clear</span></td>
                                        <td><span class="badge bg-success">✅ Compliant</span></td>
                                        <td><button class="btn btn-sm btn-outline-primary">View</button></td>
                                    </tr>
                                    <tr>
                                        <td>Pieter Botha</td>
                                        <td><span class="badge bg-success">✅ Current</span></td>
                                        <td><span class="badge bg-warning">⚠️ 18/30hrs</span></td>
                                        <td><span class="badge bg-success">✅ Verified</span></td>
                                        <td><span class="badge bg-success">✅ Clear</span></td>
                                        <td><span class="badge bg-warning">⚠️ Non-Compliant</span></td>
                                        <td><button class="btn btn-sm btn-warning">Resolve</button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity & Quick Actions -->
                <div class="row mb-4">
                    <div class="col-md-8 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Recent Activity</h5>
                            </div>
                            <div class="card-body">
                                <div class="activity-list">
                                    <div class="activity-item">
                                        <div class="activity-icon bg-info">
                                            <i class="fas fa-graduation-cap"></i>
                                        </div>
                                        <div class="activity-content">
                                            <h6 class="mb-1">CPD activity completed</h6>
                                            <p class="mb-1 small text-muted">Sarah Naidoo completed 'FAIS Compliance Update' (5 hours)</p>
                                            <small class="text-muted">2 days ago</small>
                                        </div>
                                        <button class="btn btn-sm btn-outline-primary">View CPD Details</button>
                                    </div>
                                    <div class="activity-item">
                                        <div class="activity-icon bg-warning">
                                            <i class="fas fa-exclamation-triangle"></i>
                                        </div>
                                        <div class="activity-content">
                                            <h6 class="mb-1">CPD deadline approaching</h6>
                                            <p class="mb-1 small text-muted">Pieter Botha needs 12 more CPD hours before May 31st</p>
                                            <small class="text-muted">3 days ago</small>
                                        </div>
                                        <button class="btn btn-sm btn-warning">Send Reminder</button>
                                    </div>
                                    <div class="activity-item">
                                        <div class="activity-icon bg-success">
                                            <i class="fas fa-check-circle"></i>
                                        </div>
                                        <div class="activity-content">
                                            <h6 class="mb-1">Fit & Proper verification completed</h6>
                                            <p class="mb-1 small text-muted">Lerato Dlamini - Credit check passed</p>
                                            <small class="text-muted">5 days ago</small>
                                        </div>
                                        <button class="btn btn-sm btn-outline-primary">View F&P Record</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Quick Actions</h5>
                            </div>
                            <div class="card-body">
                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary" onclick="switchRepsTab('add-tab')">
                                        <i class="fas fa-user-plus me-2"></i>Add New Representative
                                    </button>
                                    <button class="btn btn-outline-primary" onclick="switchRepsTab('debarment-tab')">
                                        <i class="fas fa-ban me-2"></i>Run Debarment Check
                                    </button>
                                    <button class="btn btn-outline-primary" onclick="switchRepsTab('reports-tab')">
                                        <i class="fas fa-file-pdf me-2"></i>View Compliance Report
                                    </button>
                                    <a href="#" class="btn btn-link text-start">
                                        CPD Dashboard
                                    </a>
                                    <a href="#" class="btn btn-link text-start">
                                        Fit & Proper Overview
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Alerts -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0">Alerts & Warnings</h5>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-warning d-flex align-items-center">
                            <i class="fas fa-clock fa-2x me-3"></i>
                            <div class="flex-grow-1">
                                <h6 class="mb-1">CPD Deadline Approaching</h6>
                                <p class="mb-0">Pieter Botha needs 12 CPD hours before May 31st (167 days remaining)</p>
                            </div>
                            <div>
                                <button class="btn btn-sm btn-warning me-2">Send Reminder</button>
                                <button class="btn btn-sm btn-outline-secondary">View CPD Plan</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. REPRESENTATIVE DIRECTORY TAB -->
        <div class="tab-pane fade" id="directory" role="tabpanel">
            <div class="container-fluid py-4">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 class="mb-0">Representative Directory</h2>
                    <button class="btn btn-outline-primary" onclick="refreshRepresentatives()">
                        <i class="fas fa-sync-alt me-1"></i>Refresh Data
                    </button>
                </div>
                
                <!-- Filters and Actions -->
                <div class="card mb-4">
                    <div class="card-body">
                        <div class="row g-3 mb-3">
                            <div class="col-md-3">
                                <label class="form-label">Status</label>
                                <select class="form-select" id="statusFilter">
                                    <option value="All">All</option>
                                    <option value="active">Active</option>
                                    <option value="suspended">Suspended</option>
                                    <option value="terminated">Terminated</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Category</label>
                                <select class="form-select" id="categoryFilter">
                                    <option value="All">All</option>
                                    <option value="class_1">Category I</option>
                                    <option value="class_2">Category II</option>
                                    <option value="class_3">Category III</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Supervisor</label>
                                <select class="form-select" id="supervisorFilter">
                                    <option value="All Supervisors">All Supervisors</option>
                                    <!-- Will be populated dynamically -->
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Search</label>
                                <input type="text" class="form-control" id="searchFilter" placeholder="Name, ID, FSP #...">
                            </div>
                        </div>
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <span class="text-muted">Showing <strong id="repCount">0</strong> representatives</span>
                            </div>
                            <div>
                                <button class="btn btn-outline-primary btn-sm" onclick="exportRepresentatives()">
                                    <i class="fas fa-download me-1"></i>Export CSV
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Representative Cards -->
                <div class="row representatives-container" id="representativesContainer">
                    <!-- Cards will be dynamically loaded here -->
                </div>
            </div>
        </div>

        <!-- 3. ADD NEW REPRESENTATIVE TAB -->
        <div class="tab-pane fade" id="add" role="tabpanel">
            <div class="container-fluid py-4">
                <!-- Representative Type Selection -->
                <div id="repTypeSelection" class="text-center">
                    <h2 class="mb-4">Select Representative Type</h2>
                    <div class="row">
                        <div class="col-md-3 mb-4">
                            <div class="rep-type-card active" data-type="individual">
                                <i class="fas fa-user fa-4x text-primary mb-3"></i>
                                <h4>Individual Representative</h4>
                                <p class="text-muted">Standard representative employed by the FSP</p>
                                <button class="btn btn-primary" onclick="startRepRegistration('individual')">Select</button>
                            </div>
                        </div>
                        <div class="col-md-3 mb-4">
                            <div class="rep-type-card" data-type="ki">
                                <i class="fas fa-award fa-4x text-success mb-3"></i>
                                <h4>Key Individual</h4>
                                <p class="text-muted">Key Individual with supervisory responsibilities</p>
                                <button class="btn btn-outline-primary" onclick="startRepRegistration('ki')">Select</button>
                            </div>
                        </div>
                        <div class="col-md-3 mb-4">
                            <div class="rep-type-card" data-type="compliance">
                                <i class="fas fa-shield-check fa-4x text-info mb-3"></i>
                                <h4>Compliance Officer</h4>
                                <p class="text-muted">Dedicated compliance officer role</p>
                                <button class="btn btn-outline-primary" onclick="startRepRegistration('compliance')">Select</button>
                            </div>
                        </div>
                        <div class="col-md-3 mb-4">
                            <div class="rep-type-card" data-type="contractor">
                                <i class="fas fa-briefcase fa-4x text-warning mb-3"></i>
                                <h4>Independent Contractor</h4>
                                <p class="text-muted">Contract-based representative</p>
                                <button class="btn btn-outline-primary" onclick="startRepRegistration('contractor')">Select</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Registration Wizard -->
                <div id="repWizard" style="display: none;">
                    <!-- Progress Indicator -->
                    <div class="wizard-progress mb-4">
                        <div class="progress-steps">
                            <div class="step active" data-step="1">
                                <div class="step-number">1</div>
                                <div class="step-label">Personal Info</div>
                            </div>
                            <div class="step" data-step="2">
                                <div class="step-number">2</div>
                                <div class="step-label">Contact</div>
                            </div>
                            <div class="step" data-step="3">
                                <div class="step-number">3</div>
                                <div class="step-label">Employment</div>
                            </div>
                            <div class="step" data-step="4">
                                <div class="step-number">4</div>
                                <div class="step-label">Categories</div>
                            </div>
                            <div class="step" data-step="5">
                                <div class="step-number">5</div>
                                <div class="step-label">Qualifications</div>
                            </div>
                            <div class="step" data-step="6">
                                <div class="step-number">6</div>
                                <div class="step-label">Fit & Proper</div>
                            </div>
                            <div class="step" data-step="7">
                                <div class="step-number">7</div>
                                <div class="step-label">FICA</div>
                            </div>
                            <div class="step" data-step="8">
                                <div class="step-number">8</div>
                                <div class="step-label">Supervision</div>
                            </div>
                            <div class="step" data-step="9">
                                <div class="step-number">9</div>
                                <div class="step-label">Review</div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Personal Information -->
                    <div class="wizard-step" id="repStep1" data-step="1">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 1: Personal Information</h5>
                            </div>
                            <div class="card-body">
                                <form id="personalInfoForm">
                                    <div class="row">
                                        <div class="col-md-2 mb-3">
                                            <label class="form-label">Title *</label>
                                            <select class="form-select" required>
                                                <option value="">Select...</option>
                                                <option>Mr</option>
                                                <option>Mrs</option>
                                                <option>Ms</option>
                                                <option>Dr</option>
                                                <option>Prof</option>
                                            </select>
                                        </div>
                                        <div class="col-md-5 mb-3">
                                            <label class="form-label">First Name *</label>
                                            <input type="text" class="form-control" id="repFirstName" name="first_name" required>
                                        </div>
                                        <div class="col-md-5 mb-3">
                                            <label class="form-label">Last Name *</label>
                                            <input type="text" class="form-control" id="repSurname" name="surname" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Date of Birth *</label>
                                            <input type="date" class="form-control" id="repDob" name="date_of_birth" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">ID/Passport Number *</label>
                                            <input type="text" class="form-control" id="repIdNumber" name="id_number" required>
                                            <small class="text-muted">Enter ID or Passport number</small>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Gender *</label>
                                            <div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="gender" id="genderMale" value="male" required>
                                                    <label class="form-check-label" for="genderMale">Male</label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="gender" id="genderFemale" value="female">
                                                    <label class="form-check-label" for="genderFemale">Female</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Nationality *</label>
                                            <select class="form-select" required>
                                                <option value="">Select...</option>
                                                <option>South African</option>
                                                <option>Other</option>
                                            </select>
                                        </div>
                                        <div class="col-12 mb-3">
                                            <label class="form-label">Profile Photo</label>
                                            <div class="upload-zone">
                                                <div class="text-center py-4">
                                                    <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                                                    <p class="mb-2"><strong>Drag & drop photo here</strong></p>
                                                    <button type="button" class="btn btn-sm btn-primary">Browse</button>
                                                    <p class="mt-2 small text-muted">JPG, PNG - Max 2MB, Recommended: 500x500px</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex gap-2 mt-4">
                                        <button type="button" class="btn btn-primary" onclick="nextRepStep(2)">Next: Contact & Address</button>
                                        <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                        <button type="button" class="btn btn-link" onclick="cancelRepRegistration()">Cancel</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Contact & Address -->
                    <div class="wizard-step" id="repStep2" data-step="2" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 2: Contact & Address</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Primary Email *</label>
                                        <input type="email" class="form-control" id="repEmail" name="email" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Primary Mobile *</label>
                                        <div class="input-group">
                                            <span class="input-group-text">+27</span>
                                            <input type="tel" class="form-control" id="repMobile" name="mobile" required>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3">
                                        <label class="form-label">Street Address *</label>
                                        <input type="text" class="form-control" required>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label">Suburb *</label>
                                        <input type="text" class="form-control" required>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label">City *</label>
                                        <input type="text" class="form-control" required>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label">Province *</label>
                                        <select class="form-select" required>
                                            <option value="">Select...</option>
                                            <option>Western Cape</option>
                                            <option>Gauteng</option>
                                            <option>KwaZulu-Natal</option>
                                            <option>Eastern Cape</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Postal Code *</label>
                                        <input type="text" class="form-control" required>
                                    </div>
                                </div>
                                <div class="d-flex gap-2 mt-4">
                                    <button type="button" class="btn btn-primary" onclick="nextRepStep(3)">Next: Employment Details</button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousRepStep(1)">Back</button>
                                    <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Employment Details -->
                    <div class="wizard-step" id="repStep3" data-step="3" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 3: Employment Details</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Start Date *</label>
                                        <input type="date" class="form-control" id="repStartDate" name="onboarding_date" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Employment Type *</label>
                                        <select class="form-select" required>
                                            <option value="">Select...</option>
                                            <option>Full-Time Employee</option>
                                            <option>Part-Time Employee</option>
                                            <option>Independent Contractor</option>
                                            <option>Tied Agent</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Job Title *</label>
                                        <input type="text" class="form-control" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Office Location *</label>
                                        <select class="form-select" required>
                                            <option value="">Select...</option>
                                            <option>Cape Town - Head Office</option>
                                            <option>Johannesburg Branch</option>
                                            <option>Durban Branch</option>
                                            <option>Remote/Work from Home</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">FSP Representative Number</label>
                                        <input type="text" class="form-control" value="Will be auto-generated" disabled>
                                        <small class="text-muted">Format: REP-[FSP#]-[XXX]</small>
                                    </div>
                                </div>
                                <div class="d-flex gap-2 mt-4">
                                    <button type="button" class="btn btn-primary" onclick="nextRepStep(4)">Next: Categories & Licenses</button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousRepStep(2)">Back</button>
                                    <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Categories & Licenses -->
                    <div class="wizard-step" id="repStep4" data-step="4" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 4: Categories & Licenses</h5>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-info">
                                    <strong>FSP Licensed Categories:</strong> I, IIA, IIB, IIIA
                                </div>
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="cat1">
                                        <label class="form-check-label" for="cat1">
                                            Category I - Advice and Intermediary Services
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="cat2a">
                                        <label class="form-check-label" for="cat2a">
                                            Category IIA - Long-term Insurance
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="cat2b">
                                        <label class="form-check-label" for="cat2b">
                                            Category IIB - Short-term Insurance
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="cat3a">
                                        <label class="form-check-label" for="cat3a">
                                            Category IIIA - Health Service Benefits
                                        </label>
                                    </div>
                                </div>
                                <div class="d-flex gap-2 mt-4">
                                    <button type="button" class="btn btn-primary" onclick="nextRepStep(5)">Next: Qualifications</button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousRepStep(3)">Back</button>
                                    <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 5: Qualifications -->
                    <div class="wizard-step" id="repStep5" data-step="5" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 5: Qualifications</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Highest Level of Education *</label>
                                    <select class="form-select" required>
                                        <option value="">Select...</option>
                                        <option>Matric/Grade 12</option>
                                        <option>Certificate</option>
                                        <option>Diploma</option>
                                        <option>Bachelor's Degree</option>
                                        <option>Honours Degree</option>
                                        <option>Master's Degree</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="re5">
                                        <label class="form-check-label" for="re5">
                                            RE5 - Regulatory Exam Part 5 (REQUIRED for Category I)
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="re1">
                                        <label class="form-check-label" for="re1">
                                            RE1 - Regulatory Exam Part 1
                                        </label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Upload Qualification Documents</label>
                                    <div class="upload-zone">
                                        <div class="text-center py-4">
                                            <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                                            <p class="mb-2"><strong>Drag & drop certificates here</strong></p>
                                            <button type="button" class="btn btn-sm btn-primary">Browse</button>
                                            <p class="mt-2 small text-muted">PDF, JPG, PNG - Max 5MB per file</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex gap-2 mt-4">
                                    <button type="button" class="btn btn-primary" onclick="nextRepStep(6)">Next: Fit & Proper</button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousRepStep(4)">Back</button>
                                    <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 6: Fit & Proper -->
                    <div class="wizard-step" id="repStep6" data-step="6" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 6: Fit & Proper Verification</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Criminal Record Check</label>
                                    <div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="criminal" id="criminalNo" value="no" checked>
                                            <label class="form-check-label" for="criminalNo">No criminal record</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="criminal" id="criminalYes" value="yes">
                                            <label class="form-check-label" for="criminalYes">Has criminal record (details required)</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <button class="btn btn-outline-primary" onclick="runDebarmentCheck()">
                                        <i class="fas fa-ban me-2"></i>Run Debarment Check
                                    </button>
                                    <span class="badge bg-success ms-2">✅ Clear</span>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Credit Check</label>
                                    <button class="btn btn-outline-primary" onclick="runCreditCheck()">
                                        <i class="fas fa-credit-card me-2"></i>Run Credit Check
                                    </button>
                                    <span class="badge bg-success ms-2">✅ Passed</span>
                                </div>
                                <div class="d-flex gap-2 mt-4">
                                    <button type="button" class="btn btn-primary" onclick="nextRepStep(7)">Next: FICA Verification</button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousRepStep(5)">Back</button>
                                    <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 7: FICA Verification -->
                    <div class="wizard-step" id="repStep7" data-step="7" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 7: FICA Verification</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Upload ID Document (Front) *</label>
                                    <div class="upload-zone">
                                        <div class="text-center py-3">
                                            <i class="fas fa-id-card fa-2x text-muted mb-2"></i>
                                            <p class="mb-1 small">Upload SA ID or Passport</p>
                                            <button type="button" class="btn btn-sm btn-primary">Browse</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Upload Proof of Address *</label>
                                    <div class="upload-zone">
                                        <div class="text-center py-3">
                                            <i class="fas fa-file-alt fa-2x text-muted mb-2"></i>
                                            <p class="mb-1 small">Utility bill, bank statement (within 3 months)</p>
                                            <button type="button" class="btn btn-sm btn-primary">Browse</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex gap-2 mt-4">
                                    <button type="button" class="btn btn-primary" onclick="nextRepStep(8)">Next: Supervision & Access</button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousRepStep(6)">Back</button>
                                    <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 8: Supervision & Access -->
                    <div class="wizard-step" id="repStep8" data-step="8" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 8: Supervision & Access</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Assign Supervisor (Key Individual)</label>
                                    <select class="form-select" id="repSupervisor">
                                        <option value="">Select Supervisor (Optional)...</option>
                                        <!-- Will be populated dynamically -->
                                    </select>
                                    <small class="text-muted">Leave blank if no supervisor assignment needed at this time</small>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">System Access Role *</label>
                                    <select class="form-select" required>
                                        <option value="">Select...</option>
                                        <option>Representative (Standard)</option>
                                        <option>Key Individual</option>
                                        <option>Compliance Officer</option>
                                        <option>Admin Staff</option>
                                    </select>
                                </div>
                                <div class="d-flex gap-2 mt-4">
                                    <button type="button" class="btn btn-primary" onclick="nextRepStep(9)">Next: Review & Submit</button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousRepStep(7)">Back</button>
                                    <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 9: Review & Submit -->
                    <div class="wizard-step" id="repStep9" data-step="9" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 9: Review & Submit</h5>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-success mb-4">
                                    <h6>Registration Status: READY TO SUBMIT</h6>
                                    <p class="mb-0">All required information has been captured.</p>
                                </div>
                                <div class="mb-4" id="registrationSummary">
                                    <h6>Registration Summary</h6>
                                    <p><strong>Name:</strong> <span id="summaryName">-</span></p>
                                    <p><strong>ID Number:</strong> <span id="summaryId">-</span></p>
                                    <p><strong>FSP Number:</strong> <span id="summaryFspNumber" class="text-muted">Will be auto-generated</span></p>
                                    <p><strong>Categories:</strong> <span id="summaryCategories">-</span></p>
                                    <p><strong>Supervisor:</strong> <span id="summarySupervisor">-</span></p>
                                    <p><strong>Onboarding Date:</strong> <span id="summaryOnboardingDate">-</span></p>
                                    <p><strong>Status:</strong> <span class="badge bg-success">Active</span></p>
                                </div>
                                <div class="d-flex gap-2 mt-4">
                                    <button type="button" class="btn btn-primary btn-lg" onclick="submitRepRegistration()">Submit Registration</button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousRepStep(8)">Back to Edit</button>
                                    <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 4. SUPERVISION STRUCTURE TAB -->
        <div class="tab-pane fade" id="supervision" role="tabpanel">
            <div class="container-fluid py-4">
                <h2 class="mb-4">Supervision Structure</h2>
                <p class="text-muted">Organizational hierarchy and supervision structure</p>
                <!-- Content will be dynamically loaded here -->
            </div>
        </div>

        <!-- 5. COMPLIANCE OVERVIEW TAB -->
        <div class="tab-pane fade" id="compliance" role="tabpanel">
            <div class="container-fluid py-4">
                <h2 class="mb-4">Compliance Overview</h2>
                <p class="text-muted">Comprehensive compliance status for all representatives</p>
                <!-- Content will be dynamically loaded here -->
            </div>
        </div>

        <!-- 6. DEBARMENT REGISTER TAB -->
        <div class="tab-pane fade" id="debarment" role="tabpanel">
            <div class="container-fluid py-4">
                <h2 class="mb-4">Debarment Register</h2>
                
                <div class="card mb-4">
                    <div class="card-body text-center py-4">
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <div class="stat-value text-success">12/12</div>
                                <div class="stat-label">Representatives Checked</div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="stat-value text-success">✅ All Clear</div>
                                <div class="stat-label">Debarment Status</div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="stat-value">01/12/2024</div>
                                <div class="stat-label">Last Check</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Debarment Check History</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Check Date</th>
                                        <th>Representatives</th>
                                        <th>Result</th>
                                        <th>Checked By</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>01/12/2024</td>
                                        <td>12</td>
                                        <td><span class="badge bg-success">✅ All Clear</span></td>
                                        <td>System (Automated)</td>
                                        <td><button class="btn btn-sm btn-outline-primary">Download Certificate</button></td>
                                    </tr>
                                    <tr>
                                        <td>01/11/2024</td>
                                        <td>12</td>
                                        <td><span class="badge bg-success">✅ All Clear</span></td>
                                        <td>System (Automated)</td>
                                        <td><button class="btn btn-sm btn-outline-primary">Download Certificate</button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-3">
                            <button class="btn btn-primary" onclick="runDebarmentCheck()">
                                <i class="fas fa-ban me-2"></i>Run Debarment Check Now
                            </button>
                            <button class="btn btn-outline-secondary ms-2" onclick="loadDebarmentRegister()">
                                <i class="fas fa-sync me-2"></i>Refresh
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 7. REPORTS TAB -->
        <div class="tab-pane fade" id="reports" role="tabpanel">
            <div class="container-fluid py-4">
                <h2 class="mb-4">Representatives Reports</h2>
                
                <div class="row">
                    <div class="col-md-4 mb-4">
                        <div class="card h-100 shadow-sm">
                            <div class="card-body text-center">
                                <i class="fas fa-users fa-3x text-primary mb-3"></i>
                                <h5>Representatives Summary</h5>
                                <p class="text-muted">Comprehensive overview of all representatives with status breakdown and categories</p>
                                <button class="btn btn-primary" onclick="generateRepresentativesSummary()">
                                    <i class="fas fa-file-alt me-2"></i>Generate Report
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100 shadow-sm">
                            <div class="card-body text-center">
                                <i class="fas fa-shield-check fa-3x text-success mb-3"></i>
                                <h5>Compliance Report</h5>
                                <p class="text-muted">Detailed compliance status covering F&P, CPD, FICA, and documents for all representatives</p>
                                <button class="btn btn-success" onclick="generateComplianceReport()">
                                    <i class="fas fa-file-chart-line me-2"></i>Generate Report
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100 shadow-sm">
                            <div class="card-body text-center">
                                <i class="fas fa-book fa-3x text-info mb-3"></i>
                                <h5>CPD Summary Report</h5>
                                <p class="text-muted">CPD hours earned, ethics training, and completion status for all active representatives</p>
                                <button class="btn btn-info" onclick="generateCPDSummary()">
                                    <i class="fas fa-graduation-cap me-2"></i>Generate Report
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://prium.github.io/phoenix/v1.23.0/assets/js/phoenix.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Data Functions -->
    <script src="../../../js/data-functions.js"></script>
    <!-- Module Scripts -->
    <script src="../js/representatives-dashboard.js"></script>
    <script src="../js/add-representative.js"></script>
    <script src="../js/representative-directory.js"></script>
    <script src="../js/supervision-structure.js"></script>
    <script src="../js/compliance-overview.js"></script>
    <script src="../js/debarment-register.js"></script>
    <script src="../js/reports.js"></script>
</body>
</html>

