<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Complaints Management - iComply</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Phoenix Theme CSS -->
    <link href="https://prium.github.io/phoenix/v1.23.0/assets/css/phoenix.min.css" rel="stylesheet">
    <link href="https://prium.github.io/phoenix/v1.23.0/assets/css/theme.min.css" rel="stylesheet">
    <!-- SweetAlert2 -->
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- Custom Styles -->
    <link href="../../../css/main.css" rel="stylesheet">
    <link href="../css/complaints-styles.css" rel="stylesheet">
</head>
<body>
    <!-- Navigation Tabs -->
    <div class="complaints-tabs-container">
        <ul class="nav nav-tabs complaints-tabs" id="complaintsTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab">
                    <i class="fas fa-chart-pie me-2"></i>Complaints Dashboard
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="log-tab" data-bs-toggle="tab" data-bs-target="#log" type="button" role="tab">
                    <i class="fas fa-plus-circle me-2"></i>Log New Complaint
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="active-tab" data-bs-toggle="tab" data-bs-target="#active" type="button" role="tab">
                    <i class="fas fa-list me-2"></i>Active Complaints <span class="badge bg-info" id="active-complaints-badge">0</span>
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="calendar-tab" data-bs-toggle="tab" data-bs-target="#calendar" type="button" role="tab">
                    <i class="fas fa-calendar me-2"></i>Complaints Calendar
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="analysis-tab" data-bs-toggle="tab" data-bs-target="#analysis" type="button" role="tab">
                    <i class="fas fa-chart-line me-2"></i>Analysis & Trends
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="ombudsman-tab" data-bs-toggle="tab" data-bs-target="#ombudsman" type="button" role="tab">
                    <i class="fas fa-balance-scale me-2"></i>Ombudsman Cases
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="reports-tab" data-bs-toggle="tab" data-bs-target="#reports" type="button" role="tab">
                    <i class="fas fa-file-alt me-2"></i>Reports
                </button>
            </li>
        </ul>
    </div>

    <!-- Tab Content -->
    <div class="tab-content complaints-content" id="complaintsTabContent">
        <!-- 1. COMPLAINTS DASHBOARD -->
        <div class="tab-pane fade show active" id="dashboard" role="tabpanel">
            <div class="container-fluid py-4">
                <!-- Compliance Status Cards -->
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="stat-card">
                            <div class="stat-icon text-primary">
                                <i class="fas fa-bullhorn fa-3x"></i>
                            </div>
                            <div class="stat-value" id="total-complaints">0</div>
                            <div class="stat-label">Total Complaints</div>
                            <div class="stat-sublabel">All time</div>
                            <small class="text-muted d-block mt-2" id="this-year-complaints">This year: 0 complaints</small>
                            <small class="text-success" id="year-over-year" style="display: none;"></small>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="stat-card">
                            <div class="stat-icon text-info">
                                <i class="fas fa-clock fa-3x"></i>
                            </div>
                            <div class="stat-value text-info" id="active-cases">0</div>
                            <div class="stat-label">Active Cases</div>
                            <div class="stat-sublabel">In progress</div>
                            <a href="#" class="btn btn-sm btn-link mt-2" onclick="switchComplaintsTab('active-tab')">View Active</a>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="stat-card">
                            <div class="stat-icon text-warning">
                                <i class="fas fa-exclamation-triangle fa-3x"></i>
                            </div>
                            <div class="stat-value text-warning" id="approaching-deadline">0</div>
                            <div class="stat-label">Approaching Deadline</div>
                            <div class="stat-sublabel">6-week deadline</div>
                            <div class="alert alert-warning mb-0 mt-2" id="deadline-alert" style="display: none;">
                                <small><strong id="deadline-days">0 days remaining</strong></small>
                            </div>
                            <a href="#" class="btn btn-sm btn-warning mt-2">Review Now</a>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="stat-card">
                            <div class="stat-icon text-success">
                                <i class="fas fa-balance-scale fa-3x"></i>
                            </div>
                            <div class="stat-value text-success" id="ombudsman-cases">0</div>
                            <div class="stat-label">Ombudsman Cases</div>
                            <div class="stat-sublabel">Escalated</div>
                            <a href="#" class="btn btn-sm btn-link mt-2" onclick="switchComplaintsTab('ombudsman-tab')">View History</a>
                        </div>
                    </div>
                </div>

                <!-- Regulatory Compliance Card -->
                <div class="card mb-4">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0"><i class="fas fa-check-circle me-2"></i>FAIS Act Compliance</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3 text-center">
                                <div class="h4 mb-0"><span class="badge bg-success fs-6" id="fais-status">‚úÖ COMPLIANT</span></div>
                                <small class="text-muted">Overall Status</small>
                            </div>
                            <div class="col-md-3 text-center">
                                <div class="h4 mb-0" id="six-week-resolution">0%</div>
                                <small class="text-muted" id="six-week-label">6-Week Resolution (0/0)</small>
                            </div>
                            <div class="col-md-3 text-center">
                                <div class="h4 mb-0" id="six-month-closure">0%</div>
                                <small class="text-muted" id="six-month-label">6-Month Closure (0/0)</small>
                            </div>
                            <div class="col-md-3 text-center">
                                <div class="h4 mb-0" id="avg-resolution-time">0 days</div>
                                <small class="text-muted">Average Resolution Time</small>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-md-6">
                                <h6>Regulatory Requirements:</h6>
                                <ul class="list-unstyled">
                                    <li><i class="fas fa-clock text-info me-2"></i>Initial Response: Within 48 hours (Required)</li>
                                    <li><i class="fas fa-calendar text-warning me-2"></i>First Resolution Attempt: Within 6 weeks (Section 26)</li>
                                    <li><i class="fas fa-check-circle text-success me-2"></i>Final Resolution: Within 6 months (Required)</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <ul class="list-unstyled">
                                    <li><i class="fas fa-chart-bar text-primary me-2"></i>Ombudsman Notification: When escalated</li>
                                    <li><i class="fas fa-file-alt text-secondary me-2"></i>Record Retention: 5 years</li>
                                    <li><i class="fas fa-calendar-check text-info me-2"></i>Last FSCA Report: <span id="last-fsca-report">N/A</span></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Status Timeline -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0">Complaints by Status</h5>
                    </div>
                    <div class="card-body">
                        <div class="status-timeline">
                            <div class="timeline-step">
                                <div class="timeline-marker bg-info" id="status-received">0</div>
                                <div class="timeline-label">Received</div>
                            </div>
                            <div class="timeline-connector"></div>
                            <div class="timeline-step">
                                <div class="timeline-marker bg-info" id="status-acknowledged">0</div>
                                <div class="timeline-label">Acknowledged</div>
                            </div>
                            <div class="timeline-connector"></div>
                            <div class="timeline-step">
                                <div class="timeline-marker bg-warning" id="status-investigating">0</div>
                                <div class="timeline-label">Investigating</div>
                            </div>
                            <div class="timeline-connector"></div>
                            <div class="timeline-step">
                                <div class="timeline-marker bg-success" id="status-resolved">0</div>
                                <div class="timeline-label">Resolved</div>
                            </div>
                            <div class="timeline-connector"></div>
                            <div class="timeline-step">
                                <div class="timeline-marker bg-secondary" id="status-closed">0</div>
                                <div class="timeline-label">Closed</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity & Quick Actions -->
                <div class="row mb-4">
                    <div class="col-md-8 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Recent Activity</h5>
                            </div>
                            <div class="card-body">
                                <div class="activity-list" id="recent-activity-list">
                                    <!-- Activity items will be loaded dynamically -->
                                    <div class="alert alert-info">
                                        <i class="fas fa-info-circle me-2"></i>
                                        Loading recent activity...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Quick Actions</h5>
                            </div>
                            <div class="card-body">
                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary" onclick="switchComplaintsTab('log-tab')">
                                        <i class="fas fa-plus me-2"></i>Log New Complaint
                                    </button>
                                    <button class="btn btn-outline-primary" onclick="switchComplaintsTab('active-tab')">
                                        <i class="fas fa-list me-2"></i>View Active Cases
                                    </button>
                                    <button class="btn btn-outline-primary" onclick="switchComplaintsTab('reports-tab')">
                                        <i class="fas fa-file-pdf me-2"></i>Generate Report
                                    </button>
                                    <a href="#" class="btn btn-link text-start" onclick="switchComplaintsTab('calendar-tab')">
                                        View Calendar
                                    </a>
                                    <a href="#" class="btn btn-link text-start">
                                        Compliance Summary
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Alerts & Statistics -->
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Alerts & Warnings</h5>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-warning d-flex align-items-center">
                                    <i class="fas fa-clock fa-2x me-3"></i>
                                    <div class="flex-grow-1">
                                        <h6 class="mb-1">Deadline Approaching</h6>
                                        <p class="mb-1">CMP-2024-007 must be resolved within 5 days (6-week deadline)</p>
                                        <small>Client: Johan van Zyl</small>
                                    </div>
                                    <div>
                                        <button class="btn btn-sm btn-warning me-2">Review Case</button>
                                        <button class="btn btn-sm btn-outline-secondary">Send Update</button>
                                    </div>
                                </div>
                                <div class="alert alert-info d-flex align-items-center">
                                    <i class="fas fa-info-circle fa-2x me-3"></i>
                                    <div class="flex-grow-1">
                                        <h6 class="mb-1">Pending Client Response</h6>
                                        <p class="mb-0">CMP-2024-007 - Awaiting documents from client</p>
                                        <small>Requested: 7 days ago</small>
                                    </div>
                                    <div>
                                        <button class="btn btn-sm btn-info me-2">Follow Up</button>
                                        <button class="btn-close" aria-label="Close"></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Complaints by Category</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="categoryChart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. LOG NEW COMPLAINT TAB -->
        <div class="tab-pane fade" id="log" role="tabpanel">
            <div class="container-fluid py-4">
                <!-- Complaint Type Selection -->
                <div id="complaintTypeSelection" class="text-center">
                    <h2 class="mb-4">Select Complaint Type</h2>
                    <div class="row">
                        <div class="col-md-4 mb-4">
                            <div class="complaint-type-card active" data-type="client">
                                <i class="fas fa-user-exclamation fa-4x text-primary mb-3"></i>
                                <h4>Client Complaint</h4>
                                <p class="text-muted">Complaint from existing client</p>
                                <button class="btn btn-primary" onclick="startComplaintLogging('client')">Select</button>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4">
                            <div class="complaint-type-card" data-type="third-party">
                                <i class="fas fa-users fa-4x text-info mb-3"></i>
                                <h4>Third Party Complaint</h4>
                                <p class="text-muted">Complaint from non-client (e.g., beneficiary)</p>
                                <button class="btn btn-outline-primary" onclick="startComplaintLogging('third-party')">Select</button>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4">
                            <div class="complaint-type-card" data-type="internal">
                                <i class="fas fa-building fa-4x text-success mb-3"></i>
                                <h4>Internal Complaint</h4>
                                <p class="text-muted">Internal issue or staff complaint</p>
                                <button class="btn btn-outline-primary" onclick="startComplaintLogging('internal')">Select</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Complaint Logging Wizard -->
                <div id="complaintWizard" style="display: none;">
                    <!-- Progress Indicator -->
                    <div class="wizard-progress mb-4">
                        <div class="progress-steps">
                            <div class="step active" data-step="1">
                                <div class="step-number">1</div>
                                <div class="step-label">Complaint Details</div>
                            </div>
                            <div class="step" data-step="2">
                                <div class="step-number">2</div>
                                <div class="step-label">Client Information</div>
                            </div>
                            <div class="step" data-step="3">
                                <div class="step-number">3</div>
                                <div class="step-label">Issue Description</div>
                            </div>
                            <div class="step" data-step="4">
                                <div class="step-number">4</div>
                                <div class="step-label">Representative</div>
                            </div>
                            <div class="step" data-step="5">
                                <div class="step-number">5</div>
                                <div class="step-label">Review & Submit</div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Complaint Details -->
                    <div class="wizard-step active" id="step1" data-step="1" style="display: block;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 1: Complaint Details</h5>
                            </div>
                            <div class="card-body">
                                <form id="complaintDetailsForm">
                                    <div class="mb-3">
                                        <label class="form-label">Complaint Reference</label>
                                        <input type="text" class="form-control" value="Will be assigned on save" disabled>
                                        <small class="text-muted">Format: CMP-YYYY-NNN</small>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Date Received *</label>
                                            <input type="date" class="form-control" id="dateReceived" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Time Received</label>
                                            <input type="time" class="form-control" id="timeReceived">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">How Received *</label>
                                            <select class="form-select" id="complaintChannel" required>
                                                <option value="">Select...</option>
                                                <option value="email">Email</option>
                                                <option value="phone">Phone Call</option>
                                                <option value="in_person">In Person</option>
                                                <option value="letter">Letter/Post</option>
                                                <option value="whatsapp">WhatsApp</option>
                                                <option value="online_form">Online Form</option>
                                                <option value="social_media">Social Media</option>
                                                <option value="other">Other</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Urgency Level *</label>
                                            <div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="urgency" id="urgencyStandard" value="standard" checked>
                                                    <label class="form-check-label" for="urgencyStandard">Standard (6-week deadline)</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="urgency" id="urgencyHigh" value="high">
                                                    <label class="form-check-label" for="urgencyHigh">High Priority (Vulnerable client, significant financial loss)</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="urgency" id="urgencyCritical" value="critical">
                                                    <label class="form-check-label" for="urgencyCritical">Critical (Regulatory risk, reputational damage)</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Primary Category *</label>
                                            <select class="form-select" id="primaryCategory" required>
                                                <option value="">Select...</option>
                                                <option value="Claims Issues">Claims Issues</option>
                                                <option value="Service Quality">Service Quality</option>
                                                <option value="Product Issues">Product Issues</option>
                                                <option value="Financial Concerns">Financial Concerns</option>
                                                <option value="Administrative">Administrative</option>
                                                <option value="Other">Other</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Sub-category *</label>
                                            <select class="form-select" id="subCategory" required>
                                                <option value="">Select primary category first</option>
                                            </select>
                                        </div>
                                        <div class="col-12 mb-3">
                                            <label class="form-label">Complaint Summary *</label>
                                            <input type="text" class="form-control" id="complaintSummary" maxlength="200" required>
                                            <small class="text-muted">Brief one-line summary (max 200 characters)</small>
                                        </div>
                                    </div>
                                    <div class="d-flex gap-2 mt-4">
                                        <button type="button" class="btn btn-primary" onclick="nextComplaintStep(2)">Next: Client Information</button>
                                        <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                        <button type="button" class="btn btn-link" onclick="cancelComplaintLogging()">Cancel</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Client Information -->
                    <div class="wizard-step" id="step2" data-step="2" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 2: Client Information</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-4">
                                    <label class="form-label">Search Existing Client</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="clientSearch" placeholder="Search by name, ID, policy number, phone...">
                                        <button class="btn btn-outline-secondary" type="button" id="searchClientBtn">Search</button>
                                    </div>
                                    <div id="clientSearchResults" class="mt-2" style="display: none;"></div>
                                </div>
                                <div class="alert alert-info">
                                    <strong>OR</strong> Client not in system? <a href="#" onclick="showNewClientForm()">Enter manually</a>
                                </div>
                                <div id="newClientForm" style="display: none;">
                                    <h6 class="mb-3">New Client Details</h6>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Full Name *</label>
                                            <input type="text" class="form-control" id="newClientName" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">ID/Passport Number</label>
                                            <input type="text" class="form-control" id="newClientId">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Email *</label>
                                            <input type="email" class="form-control" id="newClientEmail" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Mobile *</label>
                                            <div class="input-group">
                                                <span class="input-group-text">+27</span>
                                                <input type="tel" class="form-control" id="newClientMobile" required>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <input type="hidden" id="selectedClientId" value="">
                                <div class="d-flex gap-2 mt-4">
                                    <button type="button" class="btn btn-primary" onclick="nextComplaintStep(3)">Next: Issue Description</button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousComplaintStep(1)">Back</button>
                                    <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Issue Description -->
                    <div class="wizard-step" id="step3" data-step="3" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 3: Issue Description</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Detailed Description *</label>
                                    <textarea class="form-control" id="complaintDescription" rows="8" required placeholder="Please provide a detailed description of the complaint, including dates, amounts, and specific concerns..."></textarea>
                                    <small class="text-muted">Minimum 50 characters</small>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Date of Incident/Issue</label>
                                        <input type="date" class="form-control" id="incidentDate">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Financial Impact (ZAR)</label>
                                        <input type="number" class="form-control" id="financialImpact" placeholder="0.00" step="0.01">
                                    </div>
                                    <div class="col-12 mb-3">
                                        <label class="form-label">Client's Expected Resolution *</label>
                                        <textarea class="form-control" id="expectedResolution" rows="3" required placeholder="What does the client want? What would satisfy the complaint?"></textarea>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Supporting Documents</label>
                                    <div class="upload-zone">
                                        <div class="text-center py-4">
                                            <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                                            <p class="mb-2"><strong>Drag & drop documents here</strong></p>
                                            <button type="button" class="btn btn-sm btn-primary">Browse</button>
                                            <p class="mt-2 small text-muted">PDF, JPG, PNG, Word, Excel - Max 10MB per file</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex gap-2 mt-4">
                                    <button type="button" class="btn btn-primary" onclick="nextComplaintStep(4)">Next: Representative</button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousComplaintStep(2)">Back</button>
                                    <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Representative Involved -->
                    <div class="wizard-step" id="step4" data-step="4" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 4: Representative Involved</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Is complaint about a representative? *</label>
                                    <div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="repInvolved" id="repYes" value="yes">
                                            <label class="form-check-label" for="repYes">Yes - complaint involves representative conduct</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="repInvolved" id="repNo" value="no" checked>
                                            <label class="form-check-label" for="repNo">No - systemic/process/product issue</label>
                                        </div>
                                    </div>
                                </div>
                                <div id="representativeSection" style="display: none;">
                                    <div class="mb-3">
                                        <label class="form-label">Select Representative</label>
                                        <select class="form-select" id="representativeSelect">
                                            <option value="">Select representative...</option>
                                        </select>
                                        <small class="text-muted">If complaint involves multiple representatives, select the primary one</small>
                                    </div>
                                </div>
                                <div class="d-flex gap-2 mt-4">
                                    <button type="button" class="btn btn-primary" onclick="nextComplaintStep(5)">Next: Review & Submit</button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousComplaintStep(3)">Back</button>
                                    <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 5: Review & Submit -->
                    <div class="wizard-step" id="step5" data-step="5" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Step 5: Review & Submit</h5>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-success mb-4">
                                    <h6>Complaint Status: READY TO SUBMIT</h6>
                                    <p class="mb-0">All required information has been captured.</p>
                                </div>
                                <div class="mb-4">
                                    <h6>Complaint Summary</h6>
                                    <div id="reviewSummary">
                                        <p class="text-muted">Loading summary...</p>
                                    </div>
                                </div>
                                <div class="mb-4">
                                    <label class="form-label">Assign Handler *</label>
                                    <select class="form-select" id="assignedTo" required>
                                        <option value="">Select handler...</option>
                                    </select>
                                </div>
                                <div class="alert alert-info" id="deadlineInfo">
                                    <strong>Deadlines:</strong><br>
                                    <span id="sixWeekDeadline">Calculating...</span><br>
                                    <span id="sixMonthDeadline">Calculating...</span>
                                </div>
                                <div class="d-flex gap-2 mt-4">
                                    <button type="button" class="btn btn-primary btn-lg" onclick="submitComplaint()">Submit Complaint</button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousComplaintStep(4)">Back to Edit</button>
                                    <button type="button" class="btn btn-outline-secondary">Save as Draft</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. ACTIVE COMPLAINTS TAB -->
        <div class="tab-pane fade" id="active" role="tabpanel">
            <div class="container-fluid py-4">
                <h2 class="mb-4">Active Complaints</h2>
                
                <!-- Stats -->
                <div class="row mb-4">
                    <div class="col-md-3 mb-4">
                        <div class="stat-card">
                            <div class="stat-value text-info">2</div>
                            <div class="stat-label">Total Active</div>
                            <div class="stat-sublabel">In progress</div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="stat-card">
                            <div class="stat-value text-warning">1</div>
                            <div class="stat-label">Due This Week</div>
                            <div class="stat-sublabel">6-week deadline</div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="stat-card">
                            <div class="stat-value">0</div>
                            <div class="stat-label">Pending Info</div>
                            <div class="stat-sublabel">Awaiting client</div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="stat-card">
                            <div class="stat-value text-success">14 days</div>
                            <div class="stat-label">Average Age</div>
                            <div class="stat-sublabel">Current cases</div>
                        </div>
                    </div>
                </div>

                <!-- Filters -->
                <div class="card mb-4">
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-3">
                                <label class="form-label">Status</label>
                                <select class="form-select">
                                    <option>All</option>
                                    <option>Received</option>
                                    <option>Acknowledged</option>
                                    <option>In Progress</option>
                                    <option>Pending Info</option>
                                    <option>Resolved</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Priority</label>
                                <select class="form-select">
                                    <option>All</option>
                                    <option>Standard</option>
                                    <option>High</option>
                                    <option>Critical</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Category</label>
                                <select class="form-select">
                                    <option>All</option>
                                    <option>Claims</option>
                                    <option>Service</option>
                                    <option>Product</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Search</label>
                                <input type="text" class="form-control" placeholder="Reference, client, keywords...">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Complaints List -->
                <div class="card">
                    <div class="card-body">
                        <div class="row" id="complaints-list-container">
                            <!-- Complaints will be loaded dynamically here -->
                            <div class="col-12">
                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle me-2"></i>
                                    Loading complaints...
                                </div>
                            </div>
                        </div>
                        <!-- Old hard-coded complaint card (hidden) -->
                        <div class="complaint-card mb-4" style="display: none;">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div>
                                    <h5>CMP-2024-007</h5>
                                    <span class="badge bg-info me-2">üîÑ IN PROGRESS</span>
                                    <span class="badge bg-warning">‚ö†Ô∏è HIGH</span>
                                    <span class="badge bg-secondary">38 days active</span>
                                </div>
                                <div>
                                    <button class="btn btn-sm btn-primary">View Full Details</button>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <p><strong>Client:</strong> Johan van Zyl</p>
                                    <p><strong>Category:</strong> Claims Issues - Claim Delayed</p>
                                    <p><strong>Summary:</strong> Life insurance claim pending for 6 weeks - urgent financial need</p>
                                    <p><strong>Financial Impact:</strong> R150,000.00</p>
                                </div>
                                <div class="col-md-6">
                                    <p><strong>Handler:</strong> Sarah Naidoo (Compliance Officer)</p>
                                    <p><strong>6-Week Deadline:</strong> 17/12/2024 <span class="badge bg-warning">5 days ‚ö†Ô∏è</span></p>
                                    <p><strong>6-Month Deadline:</strong> 05/05/2025 (142 days)</p>
                                </div>
                            </div>
                            <div class="progress mt-3" style="height: 8px;">
                                <div class="progress-bar bg-warning" style="width: 90%"></div>
                            </div>
                            <div class="mt-3">
                                <button class="btn btn-sm btn-outline-primary me-2">Add Update</button>
                                <button class="btn btn-sm btn-outline-primary me-2">Send Communication</button>
                                <button class="btn btn-sm btn-outline-success">Resolve</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 4. COMPLAINTS CALENDAR TAB -->
        <div class="tab-pane fade" id="calendar" role="tabpanel">
            <div class="container-fluid py-4">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 class="mb-0">Complaints Calendar</h2>
                    <div>
                        <button class="btn btn-sm btn-outline-primary" onclick="switchCalendarView('month')">Month</button>
                        <button class="btn btn-sm btn-outline-primary" onclick="switchCalendarView('week')">Week</button>
                        <button class="btn btn-sm btn-outline-primary" onclick="switchCalendarView('day')">Day</button>
                        <button class="btn btn-sm btn-outline-primary" onclick="switchCalendarView('list')">List</button>
                    </div>
                </div>

                <!-- Calendar Legend -->
                <div class="card mb-4">
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-2">
                                <span class="badge bg-danger me-2">üî¥</span>
                                <small>6-Week Deadlines</small>
                            </div>
                            <div class="col-md-2">
                                <span class="badge bg-warning me-2">üü†</span>
                                <small>Follow-up Dates</small>
                            </div>
                            <div class="col-md-2">
                                <span class="badge bg-info me-2">üîµ</span>
                                <small>Scheduled Meetings</small>
                            </div>
                            <div class="col-md-2">
                                <span class="badge bg-success me-2">üü¢</span>
                                <small>Completed Milestones</small>
                            </div>
                            <div class="col-md-2">
                                <span class="badge bg-secondary me-2">üü£</span>
                                <small>Ombudsman Dates</small>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-sm btn-primary" onclick="openAddCalendarEventModal()">
                                    <i class="fas fa-plus me-1"></i>Add Event
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Calendar View -->
                <div class="card mb-4" id="calendar-view-container">
                    <div class="card-body">
                        <div id="complaints-calendar">
                            <!-- Calendar will be rendered here -->
                            <div class="text-center py-5">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Loading calendar...</span>
                                </div>
                                <p class="mt-2 text-muted">Loading calendar...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Deadline Tracker -->
                <div class="row mb-4">
                    <div class="col-md-4 mb-4">
                        <div class="card">
                            <div class="card-header bg-danger text-white">
                                <h5 class="mb-0">Within 7 Days</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-sm" id="deadlines-7days">
                                        <thead>
                                            <tr>
                                                <th>Reference</th>
                                                <th>Date</th>
                                                <th>Days</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td colspan="4" class="text-center text-muted">Loading...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card">
                            <div class="card-header bg-warning text-dark">
                                <h5 class="mb-0">Within 30 Days</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-sm" id="deadlines-30days">
                                        <thead>
                                            <tr>
                                                <th>Reference</th>
                                                <th>Date</th>
                                                <th>Days</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td colspan="4" class="text-center text-muted">Loading...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card">
                            <div class="card-header bg-info text-white">
                                <h5 class="mb-0">6-Month Deadlines</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-sm" id="deadlines-6months">
                                        <thead>
                                            <tr>
                                                <th>Reference</th>
                                                <th>Date</th>
                                                <th>Days</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td colspan="4" class="text-center text-muted">Loading...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Scheduled Activities -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Scheduled Activities</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6>This Week</h6>
                                <div id="activities-this-week">
                                    <p class="text-muted">Loading...</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6>Next Week</h6>
                                <div id="activities-next-week">
                                    <p class="text-muted">Loading...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 5. ANALYSIS & TRENDS TAB -->
        <div class="tab-pane fade" id="analysis" role="tabpanel">
            <div class="container-fluid py-4">
                <h2 class="mb-4">Analysis & Trends</h2>

                <!-- Overview Statistics -->
                <div class="row mb-4">
                    <div class="col-md-3 mb-4">
                        <div class="stat-card">
                            <div class="stat-value" id="ytd-total">0</div>
                            <div class="stat-label">Total Complaints (YTD)</div>
                            <div class="stat-sublabel" id="ytd-year">2024</div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="stat-card">
                            <div class="stat-value text-success" id="ytd-resolved">0</div>
                            <div class="stat-label">Resolved</div>
                            <div class="stat-sublabel" id="ytd-resolved-percent">0%</div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="stat-card">
                            <div class="stat-value text-info" id="ytd-active">0</div>
                            <div class="stat-label">Active</div>
                            <div class="stat-sublabel" id="ytd-active-percent">0%</div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="stat-card">
                            <div class="stat-value text-warning" id="avg-resolution-time">0</div>
                            <div class="stat-label">Avg Resolution Time</div>
                            <div class="stat-sublabel">Days</div>
                        </div>
                    </div>
                </div>

                <!-- Charts Row 1 -->
                <div class="row mb-4">
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Complaints by Category</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="analysisCategoryChart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Resolution Time Trend</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="resolutionTrendChart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts Row 2 -->
                <div class="row mb-4">
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Complaints Trend Over Time</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="trendOverTimeChart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Resolution Time Distribution</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="resolutionTimeDistributionChart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts Row 3 -->
                <div class="row mb-4">
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Complaints by Priority</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="priorityChart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Complaints by Status</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="statusChart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Representative Analysis -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0">Complaints by Representative</h5>
                    </div>
                    <div class="card-body">
                        <canvas id="representativeChart" height="100"></canvas>
                    </div>
                </div>

                <!-- Compliance Metrics -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">FAIS Act Compliance Metrics</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3 text-center mb-3">
                                <div class="h4 mb-0 text-success" id="compliance-48hr">0%</div>
                                <small class="text-muted">48-Hour Acknowledgment</small>
                            </div>
                            <div class="col-md-3 text-center mb-3">
                                <div class="h4 mb-0 text-success" id="compliance-6week">0%</div>
                                <small class="text-muted">6-Week Resolution Rate</small>
                            </div>
                            <div class="col-md-3 text-center mb-3">
                                <div class="h4 mb-0 text-success" id="compliance-6month">0%</div>
                                <small class="text-muted">6-Month Closure Rate</small>
                            </div>
                            <div class="col-md-3 text-center mb-3">
                                <div class="h4 mb-0 text-success" id="compliance-escalation">0%</div>
                                <small class="text-muted">Escalation Rate</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 6. OMBUDSMAN CASES TAB -->
        <div class="tab-pane fade" id="ombudsman" role="tabpanel">
            <div class="container-fluid py-4">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 class="mb-0">Ombudsman Cases</h2>
                    <button class="btn btn-primary" onclick="if(typeof loadOmbudsmanCases === 'function') { loadOmbudsmanCases(); } else if(typeof window.loadOmbudsmanCases === 'function') { window.loadOmbudsmanCases(); } else { alert('Function not available'); }">
                        <i class="fas fa-sync me-2"></i>Refresh
                    </button>
                </div>
                
                <div id="ombudsman-cases-container">
                    <div class="text-center py-5">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-2 text-muted">Loading Ombudsman cases...</p>
                        <p class="mt-2 text-muted small">Click "Refresh" if cases don't load automatically</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script>
            // Ensure Ombudsman cases load when tab is shown
            (function() {
                function setupOmbudsmanTabListener() {
                    const ombudsmanTab = document.getElementById('ombudsman-tab');
                    const ombudsmanPane = document.getElementById('ombudsman');
                    
                    if (ombudsmanTab) {
                        // Remove any existing listeners
                        const newTab = ombudsmanTab.cloneNode(true);
                        ombudsmanTab.parentNode.replaceChild(newTab, ombudsmanTab);
                        
                        // Add new listener
                        document.getElementById('ombudsman-tab').addEventListener('shown.bs.tab', function() {
                            console.log('Ombudsman tab clicked, loading cases...');
                            if (typeof loadOmbudsmanCases === 'function') {
                                loadOmbudsmanCases();
                            } else if (typeof window.loadOmbudsmanCases === 'function') {
                                window.loadOmbudsmanCases();
                            } else {
                                console.error('loadOmbudsmanCases function not found');
                            }
                        });
                    }
                    
                    if (ombudsmanPane) {
                        // Also listen for when the pane becomes visible
                        const observer = new MutationObserver(function(mutations) {
                            if (ombudsmanPane.classList.contains('active') && ombudsmanPane.classList.contains('show')) {
                                console.log('Ombudsman pane visible, loading cases...');
                                if (typeof loadOmbudsmanCases === 'function') {
                                    loadOmbudsmanCases();
                                } else if (typeof window.loadOmbudsmanCases === 'function') {
                                    window.loadOmbudsmanCases();
                                }
                            }
                        });
                        
                        observer.observe(ombudsmanPane, {
                            attributes: true,
                            attributeFilter: ['class']
                        });
                    }
                }
                
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', setupOmbudsmanTabListener);
                } else {
                    setupOmbudsmanTabListener();
                }
            })();
        </script>

        <!-- 7. REPORTS TAB -->
        <div class="tab-pane fade" id="reports" role="tabpanel">
            <div class="container-fluid py-4">
                <h2 class="mb-4">Complaints Reports</h2>
                
                <div class="row">
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-chart-bar fa-3x text-primary mb-3"></i>
                                <h5>Complaints Summary</h5>
                                <p class="text-muted">Comprehensive overview of all complaints</p>
                                <button class="btn btn-primary">Generate</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-award fa-3x text-success mb-3"></i>
                                <h5>Compliance Certificate</h5>
                                <p class="text-muted">FAIS Act Section 26 compliance certificate</p>
                                <button class="btn btn-success">Generate</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-file-text fa-3x text-info mb-3"></i>
                                <h5>Individual Complaint Report</h5>
                                <p class="text-muted">Detailed report for specific complaint</p>
                                <button class="btn btn-info">Generate</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Complaint Detail Modal -->
    <div class="modal fade" id="complaintDetailModal" tabindex="-1" aria-labelledby="complaintDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="complaintDetailModalLabel">Complaint Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="complaintDetailContent">
                    <div class="text-center py-5">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-2 text-muted">Loading complaint details...</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="editComplaintBtn" onclick="editComplaintFromModal()">Edit Complaint</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Complaint Modal -->
    <div class="modal fade" id="editComplaintModal" tabindex="-1" aria-labelledby="editComplaintModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="editComplaintModalLabel">Edit Complaint</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="editComplaintForm" onsubmit="saveComplaintChanges(event)">
                    <div class="modal-body">
                        <input type="hidden" id="editComplaintId" name="complaintId">
                        
                        <!-- Status -->
                        <div class="mb-3">
                            <label for="editComplaintStatus" class="form-label">Status <span class="text-danger">*</span></label>
                            <select class="form-select" id="editComplaintStatus" name="status" required>
                                <option value="">Select Status</option>
                                <option value="open">Open</option>
                                <option value="acknowledged">Acknowledged</option>
                                <option value="investigating">Investigating</option>
                                <option value="pending_info">Pending Info</option>
                                <option value="resolved">Resolved</option>
                                <option value="closed">Closed</option>
                            </select>
                        </div>

                        <!-- Priority -->
                        <div class="mb-3">
                            <label for="editComplaintPriority" class="form-label">Priority</label>
                            <select class="form-select" id="editComplaintPriority" name="priority">
                                <option value="">Select Priority</option>
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                                <option value="critical">Critical</option>
                            </select>
                        </div>

                        <!-- Assigned To -->
                        <div class="mb-3">
                            <label for="editComplaintAssignedTo" class="form-label">Assigned To</label>
                            <select class="form-select" id="editComplaintAssignedTo" name="assigned_to">
                                <option value="">Unassigned</option>
                                <!-- Will be populated dynamically -->
                            </select>
                        </div>

                        <!-- Acknowledgement Sent Date -->
                        <div class="mb-3">
                            <label for="editComplaintAckDate" class="form-label">Acknowledgement Sent Date</label>
                            <input type="date" class="form-control" id="editComplaintAckDate" name="acknowledgement_sent_date">
                        </div>

                        <!-- Resolution Date -->
                        <div class="mb-3">
                            <label for="editComplaintResolutionDate" class="form-label">Resolution Date</label>
                            <input type="date" class="form-control" id="editComplaintResolutionDate" name="resolution_date">
                        </div>

                        <!-- Investigation Notes -->
                        <div class="mb-3">
                            <label for="editComplaintInvestigationNotes" class="form-label">Investigation Notes</label>
                            <textarea class="form-control" id="editComplaintInvestigationNotes" name="investigation_notes" rows="4" placeholder="Enter investigation notes..."></textarea>
                        </div>

                        <!-- Resolution Description -->
                        <div class="mb-3">
                            <label for="editComplaintResolutionDescription" class="form-label">Resolution Description</label>
                            <textarea class="form-control" id="editComplaintResolutionDescription" name="resolution_description" rows="4" placeholder="Enter resolution description..."></textarea>
                        </div>

                        <!-- Root Cause -->
                        <div class="mb-3">
                            <label for="editComplaintRootCause" class="form-label">Root Cause</label>
                            <textarea class="form-control" id="editComplaintRootCause" name="root_cause" rows="3" placeholder="Enter root cause analysis..."></textarea>
                        </div>

                        <!-- Preventative Action -->
                        <div class="mb-3">
                            <label for="editComplaintPreventativeAction" class="form-label">Preventative Action</label>
                            <textarea class="form-control" id="editComplaintPreventativeAction" name="preventative_action" rows="3" placeholder="Enter preventative actions taken..."></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-1"></i>Save Changes
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://prium.github.io/phoenix/v1.23.0/assets/js/phoenix.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="../../../js/data-functions.js"></script>
    <script src="../js/complaints-dashboard.js"></script>
    <script src="../js/log-complaint.js"></script>
    <script src="../js/active-complaints.js"></script>
    <script src="../js/complaints-calendar.js"></script>
    <script src="../js/complaints-analysis.js"></script>
    <script src="../js/ombudsman-cases.js"></script>
</body>
</html>

